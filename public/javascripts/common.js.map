{"version":3,"sources":["common.js"],"names":["$","calcWorkers","val","calcInputs","Math","floor","calcAvgSalary","console","log","calcRatio","calcMargin","calcWorkdays","getResult","valueName","funcName","separatedResult","String","replace","attr","text","onCalcSubmit","evt","preventDefault","calcResults","removeClass","onScroll","target","window","scrollTop","navCoords","css","onLinkClick","id","this","top","offset","spyScroll","animate","scrollHandler","call","displayMoveUpLink","halfHeight","height","currentPos","addClass","getPositions","progressMinWidth","row","left","sections","each","idx","el","positions","getComputedWidth","links","lastTarget","setActive","w","outerWidth","p","result","index","i","progressEl","width","AOS","init","duration","disable","workers","average-salary","ratio","margin","workdays","last","slice","on","document","debounce"],"mappings":"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","file":"../sources/common.js","sourcesContent":["$(() =>{\r\n\tAOS.init({\r\n\t\tduration: 600,\r\n\t\tdisable: 'mobile'\r\n\t});\r\n\r\n\tconst calcInputs =\r\n\t{\r\n\t\t\"workers\": $('.calc-item__input[data-calc=\"workers\"]'),\r\n\t\t\"average-salary\": $('.calc-item__input[data-calc=\"average-salary\"]'),\r\n\t\t\"ratio\": $('.calc-item__input[data-calc=\"ratio\"]'),\r\n\t\t\"margin\": $('.calc-item__input[data-calc=\"margin\"]'),\r\n\t\t\"workdays\": $('.calc-item__input[data-calc=\"workdays\"]'),\r\n\t}\r\n\r\n\tconst calcResults =\r\n\t{\r\n\t\t\"workers\": $('.calc-item__result[data-calc=\"workers\"]'),\r\n\t\t\"average-salary\": $('.calc-item__result[data-calc=\"average-salary\"]'),\r\n\t\t\"ratio\": $('.calc-item__result[data-calc=\"ratio\"]'),\r\n\t\t\"margin\": $('.calc-item__result[data-calc=\"margin\"]'),\r\n\t\t\"workdays\": $('.calc-item__result[data-calc=\"workdays\"]'),\r\n\t}\r\n\r\n\tfunction calcWorkers() {\r\n\t\tlet val = calcInputs[\"average-salary\"].val();\r\n\t\treturn Math.floor(+val * 1.42);\r\n\t}\r\n\r\n\tfunction calcAvgSalary() {\r\n\t\tlet val = calcInputs[\"workers\"].val();\r\n\t\tconsole.log(\"val: \", val);\r\n\t\treturn Math.floor(calcWorkers() * +val);\r\n\t}\r\n\r\n\tfunction calcRatio() {\r\n\t\tlet val = calcInputs[\"ratio\"].val();\r\n\t\t\r\n\t\tconsole.log(\"val: \", val);\r\n\t\treturn Math.floor(calcAvgSalary() / +val * 100);\r\n\t}\r\n\r\n\tfunction calcMargin() {\r\n\t\tlet val = calcInputs[\"margin\"].val();\r\n\t\t\r\n\t\tconsole.log(\"val: \", val);\r\n\t\treturn Math.floor(calcRatio() / +val * 100);\r\n\t}\r\n\r\n\tfunction calcWorkdays() {\r\n\t\tlet val = calcInputs[\"workdays\"].val();\r\n\t\treturn Math.floor(calcMargin() / +val);\r\n\t}\r\n\r\n\tfunction getResult(valueName, funcName) {\r\n\t\tconst separatedResult = String(funcName).replace(/(\\d)(?=(\\d{3})+([^\\d]|$))/g, '$1 ');\r\n\t\tconst setTitle = valueName.attr('title', separatedResult + ' ₽');\r\n\t\tconst setResult = valueName.text(separatedResult);\r\n\t}\r\n\r\n\tfunction onCalcSubmit(evt) {\r\n\t\tevt.preventDefault();\r\n\t\tgetResult(calcResults['workers'], calcWorkers());\r\n\t\tgetResult(calcResults['average-salary'], calcAvgSalary());\r\n\t\tgetResult(calcResults['ratio'], calcRatio());\r\n\t\tgetResult(calcResults['margin'], calcMargin());\r\n\t\tgetResult(calcResults['workdays'], calcWorkdays());\r\n\t\t$('.calc__row--hidden').removeClass('calc__row--hidden');\r\n\t\t$('.calc__btn').text('Пересчитать');\r\n\t}\r\n\r\n\tconst navCoords = $('.intro').offset().top;\r\n\tfunction onScroll () {\r\n\t\tconst target = $('.main-nav');\r\n\t\tif ($(window).scrollTop() >= navCoords) {\r\n\t\t\ttarget.css('position', 'fixed');\r\n\t\t\ttarget.css('top', '0');\r\n\t\t} else {\r\n\t\t\ttarget.css('position', 'absolute');\r\n\t\t\ttarget.css('top', '100%');\r\n\t\t}\r\n\t};\r\n\r\n\tconst sections = $('.section[id]');\r\n\tconst progressEl = $('.main-nav__progress');\r\n\tconst row = $('.main-nav__row');\r\n\tconst positions = {};\r\n\tconst links = $('.main-nav__link');\r\n\tconst lastTarget = $('.main-nav__link').last().attr('href').slice(1);\r\n\tlet spyScroll = true;\r\n\tlet progressWidth = 0;\r\n\tlet progressMinWidth = 0;\r\n\r\n\tfunction onLinkClick(evt) {\r\n\t\tevt.preventDefault();\r\n\t\tconst target = $(this);\r\n\t\tconst id  = $(this).attr('href');\r\n\t\tconst top = $(id).offset().top + 10;\r\n\t\tspyScroll = false;\r\n\r\n\t\t$('html').animate({scrollTop: top}, 1000, () => {\r\n\t\t\tspyScroll = true;\r\n\r\n\t\t\tscrollHandler.call(null)\r\n\t\t});\r\n\t}\r\n\r\n\tfunction displayMoveUpLink () {\r\n\t\tconst target = $('.move-up');\r\n\t\tlet halfHeight = $('html').height() / 3;\r\n\t\tlet currentPos = $(window).scrollTop();\r\n\t\tif (currentPos >= halfHeight) {\r\n\t\t\ttarget.removeClass('move-up--hidden');\r\n\t\t} else {\r\n\t\t\ttarget.addClass('move-up--hidden');\r\n\t\t}\r\n\t}\r\n\t\r\n\tfunction getPositions () {\r\n\t\tprogressMinWidth = row.offset().left;\r\n\t\tsections.each((idx, el) => {\r\n\t\t\tpositions[el.id]= $(el).offset().top\r\n\t\t});\r\n\t}\r\n\r\n\tfunction getComputedWidth (target) {\r\n\r\n\t\tif(!target) {\r\n\t\t\tlinks.removeClass('is-active');\r\n\t\t\treturn progressMinWidth;\r\n\t\t}\r\n\r\n\t\tconst el = $(`.main-nav__link[href=\"#${target}\"]`);\r\n\r\n\t\tif(target === lastTarget) {\r\n\t\t\tsetActive(el);\r\n\t\t\t$('.move-up').addClass('is-active');\r\n\t\t\treturn '100%';\r\n\t\t} else {\r\n\t\t\t$('.move-up').removeClass('is-active');\r\n\t\t}\r\n\r\n\t\tconst w = el.outerWidth() || 0;\r\n\t\tconst p = el.offset().left || 0;\r\n\t\tconst result = p + w;\r\n\r\n\t\tsetActive(el);\r\n\t\treturn result <= 0 ? progressMinWidth : result;\r\n\t}\r\n\r\n\tfunction setActive (el) {\r\n\t\tel.addClass('is-active');\r\n\t\t$(`.main-nav__link:lt(${el.index()})`).addClass('is-active');\r\n\t\t$(`.main-nav__link:gt(${el.index()})`).removeClass('is-active');\r\n\t}\r\n\r\n\tfunction scrollHandler () {\r\n\t\tif(!spyScroll) return;\r\n\t\tspyScroll = true;\r\n\t\tconst top = $(window).scrollTop();\r\n\t\tlet target = null;\r\n\t\tfor (let i in positions) {\r\n\t\t\tif (positions[i] <= top) {\r\n\t\t\t\ttarget = i;\r\n\t\t\t}\r\n\t\t}\r\n\t\tconst w = getComputedWidth(target);\r\n\t\tprogressEl.width(w);\r\n\t}\r\n\r\n\tdisplayMoveUpLink();\r\n\tgetPositions();\r\n\tscrollHandler();\r\n\r\n\t$('.calc__form').on('submit', onCalcSubmit);\r\n\tonScroll();\r\n\r\n\t$(document).on('scroll', onScroll);\r\n\r\n\tlinks.on('click', onLinkClick);\r\n\t$('.move-up').on('click', onLinkClick);\r\n\r\n\t$(window)\r\n\t.on('resize', $.debounce(100, getPositions))\r\n\t.on('scroll', $.debounce(100, scrollHandler))\r\n\t.on('scroll', $.debounce(100, displayMoveUpLink));\r\n})"]}