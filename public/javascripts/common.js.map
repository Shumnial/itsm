{"version":3,"sources":["common.js"],"names":["$","calcWorkers","val","calcInputs","Math","floor","calcAvgSalary","calcRatio","calcMargin","calcWorkdays","getResult","valueName","funcName","separatedResult","String","replace","attr","text","onCalcSubmit","evt","preventDefault","calcResults","removeClass","onScroll","target","window","scrollTop","navCoords","css","onLinkClick","id","this","top","offset","spyScroll","animate","scrollHandler","call","displayMoveUpLink","halfHeight","height","currentPos","addClass","getPositions","navHeight","progressMinWidth","row","left","sections","each","idx","el","positions","getComputedWidth","links","lastTarget","setActive","w","outerWidth","p","result","index","i","progressEl","width","AOS","init","duration","disable","workers","average-salary","ratio","margin","workdays","last","slice","on","document","debounce"],"mappings":"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","file":"../sources/common.js","sourcesContent":["$(() =>{\r\n\tAOS.init({\r\n\t\tduration: 600,\r\n\t\tdisable: 'mobile'\r\n\t});\r\n\r\n\tconst calcInputs =\r\n\t{\r\n\t\t\"workers\": $('.calc-item__input[data-calc=\"workers\"]'),\r\n\t\t\"average-salary\": $('.calc-item__input[data-calc=\"average-salary\"]'),\r\n\t\t\"ratio\": $('.calc-item__input[data-calc=\"ratio\"]'),\r\n\t\t\"margin\": $('.calc-item__input[data-calc=\"margin\"]'),\r\n\t\t\"workdays\": $('.calc-item__input[data-calc=\"workdays\"]'),\r\n\t}\r\n\r\n\tconst calcResults =\r\n\t{\r\n\t\t\"workers\": $('.calc-item__result[data-calc=\"workers\"]'),\r\n\t\t\"average-salary\": $('.calc-item__result[data-calc=\"average-salary\"]'),\r\n\t\t\"ratio\": $('.calc-item__result[data-calc=\"ratio\"]'),\r\n\t\t\"margin\": $('.calc-item__result[data-calc=\"margin\"]'),\r\n\t\t\"workdays\": $('.calc-item__result[data-calc=\"workdays\"]'),\r\n\t}\r\n\r\n\tfunction calcWorkers() {\r\n\t\tlet val = calcInputs[\"average-salary\"].val();\r\n\t\treturn Math.floor(+val * 1.42);\r\n\t}\r\n\r\n\tfunction calcAvgSalary() {\r\n\t\tlet val = calcInputs[\"workers\"].val();\r\n\t\treturn Math.floor(calcWorkers() * +val);\r\n\t}\r\n\r\n\tfunction calcRatio() {\r\n\t\t// Усредненное значение\r\n\t\tlet val = 35;\r\n\t\treturn Math.floor(calcAvgSalary() / +val * 100);\r\n\t}\r\n\r\n\tfunction calcMargin() {\r\n\t\tlet val = calcInputs[\"margin\"].val();\r\n\t\treturn Math.floor(calcRatio() / +val * 100);\r\n\t}\r\n\r\n\tfunction calcWorkdays() {\r\n\t\tlet val = calcInputs[\"workdays\"].val();\r\n\t\treturn Math.floor(calcMargin() / +val);\r\n\t}\r\n\r\n\tfunction getResult(valueName, funcName) {\r\n\t\tconst separatedResult = String(funcName).replace(/(\\d)(?=(\\d{3})+([^\\d]|$))/g, '$1 ');\r\n\t\tconst setTitle = valueName.attr('title', separatedResult + ' ₽');\r\n\t\tconst setResult = valueName.text(separatedResult);\r\n\t}\r\n\r\n\tfunction onCalcSubmit(evt) {\r\n\t\tevt.preventDefault();\r\n\t\tgetResult(calcResults['workers'], calcWorkers());\r\n\t\tgetResult(calcResults['average-salary'], calcAvgSalary());\r\n\t\tgetResult(calcResults['ratio'], calcRatio());\r\n\t\tgetResult(calcResults['margin'], calcMargin());\r\n\t\tgetResult(calcResults['workdays'], calcWorkdays());\r\n\t\t$('.calc__row--hidden').removeClass('calc__row--hidden');\r\n\t\t$('.calc__note--hidden').removeClass('calc__note--hidden');\r\n\t\t$('.calc__btn').text('Пересчитать');\r\n\t}\r\n\r\n\tconst navCoords = $('.intro').offset().top;\r\n\tfunction onScroll () {\r\n\t\tconst target = $('.main-nav');\r\n\t\tif ($(window).scrollTop() >= navCoords) {\r\n\t\t\ttarget.css('position', 'fixed');\r\n\t\t\ttarget.css('top', '0');\r\n\t\t} else {\r\n\t\t\ttarget.css('position', 'absolute');\r\n\t\t\ttarget.css('top', '100%');\r\n\t\t}\r\n\t};\r\n\r\n\tconst sections = $('.section[id]');\r\n\tconst progressEl = $('.main-nav__progress');\r\n\tconst row = $('.main-nav__row');\r\n\tconst positions = {};\r\n\tconst links = $('.main-nav__link');\r\n\tconst lastTarget = $('.main-nav__link').last().attr('href').slice(1);\r\n\tlet spyScroll = true;\r\n\tlet progressWidth = 0;\r\n\tlet progressMinWidth = 0;\r\n\r\n\tfunction onLinkClick(evt) {\r\n\t\tevt.preventDefault();\r\n\t\tconst target = $(this);\r\n\t\tconst id  = $(this).attr('href');\r\n\t\tconst top = $(id).offset().top + 10;\r\n\t\tspyScroll = false;\r\n\r\n\t\t$('html').animate({scrollTop: top}, 1000, () => {\r\n\t\t\tspyScroll = true;\r\n\r\n\t\t\tscrollHandler.call(null)\r\n\t\t});\r\n\t}\r\n\r\n\tfunction displayMoveUpLink () {\r\n\t\tconst target = $('.move-up');\r\n\t\tlet halfHeight = $('html').height() / 3;\r\n\t\tlet currentPos = $(window).scrollTop();\r\n\t\tif (currentPos >= halfHeight) {\r\n\t\t\ttarget.removeClass('move-up--hidden');\r\n\t\t} else {\r\n\t\t\ttarget.addClass('move-up--hidden');\r\n\t\t}\r\n\t}\r\n\t\r\n\tfunction getPositions () {\r\n\t\tconst navHeight = $('.main-nav').height();\r\n\t\tprogressMinWidth = row.offset().left;\r\n\t\tsections.each((idx, el) => {\r\n\t\t\tpositions[el.id]= $(el).offset().top - navHeight;\r\n\t\t});\r\n\t}\r\n\r\n\tfunction getComputedWidth (target) {\r\n\r\n\t\tif(!target) {\r\n\t\t\tlinks.removeClass('is-active');\r\n\t\t\treturn progressMinWidth;\r\n\t\t}\r\n\r\n\t\tconst el = $(`.main-nav__link[href=\"#${target}\"]`);\r\n\r\n\t\tif(target === lastTarget) {\r\n\t\t\tsetActive(el);\r\n\t\t\t$('.move-up').addClass('is-active');\r\n\t\t\treturn '100%';\r\n\t\t} else {\r\n\t\t\t$('.move-up').removeClass('is-active');\r\n\t\t}\r\n\r\n\t\tconst w = el.outerWidth() || 0;\r\n\t\tconst p = el.offset().left || 0;\r\n\t\tconst result = p + w;\r\n\r\n\t\tsetActive(el);\r\n\t\treturn result <= 0 ? progressMinWidth : result;\r\n\t}\r\n\r\n\tfunction setActive (el) {\r\n\t\tel.addClass('is-active');\r\n\t\t$(`.main-nav__link:lt(${el.index()})`).addClass('is-active');\r\n\t\t$(`.main-nav__link:gt(${el.index()})`).removeClass('is-active');\r\n\t}\r\n\r\n\tfunction scrollHandler () {\r\n\t\tif(!spyScroll) return;\r\n\t\tspyScroll = true;\r\n\t\tconst top = $(window).scrollTop();\r\n\t\tlet target = null;\r\n\t\tfor (let i in positions) {\r\n\t\t\tif (positions[i] <= top) {\r\n\t\t\t\ttarget = i;\r\n\t\t\t}\r\n\t\t}\r\n\t\tconst w = getComputedWidth(target);\r\n\t\tprogressEl.width(w);\r\n\t}\r\n\r\n\tdisplayMoveUpLink();\r\n\tgetPositions();\r\n\tscrollHandler();\r\n\r\n\t$('.calc__form').on('submit', onCalcSubmit);\r\n\tonScroll();\r\n\r\n\t$(document).on('scroll', onScroll);\r\n\r\n\tlinks.on('click', onLinkClick);\r\n\t$('.move-up').on('click', onLinkClick);\r\n\r\n\t$(window)\r\n\t.on('resize', $.debounce(100, getPositions))\r\n\t.on('scroll', $.debounce(100, scrollHandler))\r\n\t.on('scroll', $.debounce(100, displayMoveUpLink));\r\n})"]}