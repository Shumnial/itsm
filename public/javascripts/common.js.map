{"version":3,"sources":["common.js"],"names":["$","calcWorkers","Math","floor","calcInputs","val","calcAvgSalary","calcRatio","calcMargin","calcWorkdays","getResult","valueName","funcName","separatedResult","String","replace","attr","text","onCalcSubmit","evt","preventDefault","calcResults","removeClass","onScroll","target","window","scrollTop","navCoords","css","AOS","init","duration","disable","workers","average-salary","ratio","margin","workdays","links","linksWidth","0","1","2","3","4","i","length","eq","outerWidth","offset","top","on","document","onLinkClick","id","this","spyScroll","animate","scrollHandler","call","getPositions","progressMinWidth","row","left","sections","each","idx","el","positions","getComputedWidth","lastTarget","setActive","w","p","result","addClass","index","progressEl","width","last","slice","debounce"],"mappings":"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","file":"../sources/common.js","sourcesContent":["$(() =>{\r\n\tAOS.init({\r\n\t\tduration: 600,\r\n\t\tdisable: 'mobile'\r\n\t});\r\n\r\n\tconst calcInputs =\r\n\t{\r\n\t\t\"workers\": $('.calc-item__input[data-calc=\"workers\"]'),\r\n\t\t\"average-salary\": $('.calc-item__input[data-calc=\"average-salary\"]'),\r\n\t\t\"ratio\": $('.calc-item__input[data-calc=\"ratio\"]'),\r\n\t\t\"margin\": $('.calc-item__input[data-calc=\"margin\"]'),\r\n\t\t\"workdays\": $('.calc-item__input[data-calc=\"workdays\"]'),\r\n\t}\r\n\r\n\tconst calcResults =\r\n\t{\r\n\t\t\"workers\": $('.calc-item__result[data-calc=\"workers\"]'),\r\n\t\t\"average-salary\": $('.calc-item__result[data-calc=\"average-salary\"]'),\r\n\t\t\"ratio\": $('.calc-item__result[data-calc=\"ratio\"]'),\r\n\t\t\"margin\": $('.calc-item__result[data-calc=\"margin\"]'),\r\n\t\t\"workdays\": $('.calc-item__result[data-calc=\"workdays\"]'),\r\n\t}\r\n\r\n\tfunction calcWorkers() {\r\n\t\treturn Math.floor(+calcInputs[\"average-salary\"].val() * 1.42);\r\n\t}\r\n\r\n\tfunction calcAvgSalary() {\r\n\t\treturn Math.floor(calcWorkers() * +calcInputs[\"workers\"].val());\r\n\t}\r\n\r\n\tfunction calcRatio() {\r\n\t\treturn Math.floor(calcAvgSalary() / +calcInputs[\"ratio\"].val() * 100);\r\n\t}\r\n\r\n\tfunction calcMargin() {\r\n\t\treturn Math.floor(calcRatio() / +calcInputs[\"margin\"].val() * 100);\r\n\t}\r\n\r\n\tfunction calcWorkdays() {\r\n\t\treturn Math.floor(calcMargin() / +calcInputs[\"workdays\"].val() * 100);\r\n\t}\r\n\r\n\tfunction getResult(valueName, funcName) {\r\n\t\tconst separatedResult = String(funcName).replace(/(\\d)(?=(\\d{3})+([^\\d]|$))/g, '$1 ');\r\n\t\tconst setTitle = valueName.attr('title', separatedResult + ' ₽');\r\n\t\tconst setResult = valueName.text(separatedResult);\r\n\t}\r\n\r\n\tfunction onCalcSubmit(evt) {\r\n\t\tevt.preventDefault();\r\n\t\tgetResult(calcResults['workers'], calcWorkers());\r\n\t\tgetResult(calcResults['average-salary'], calcAvgSalary());\r\n\t\tgetResult(calcResults['ratio'], calcRatio());\r\n\t\tgetResult(calcResults['margin'], calcMargin());\r\n\t\tgetResult(calcResults['workdays'], calcWorkdays());\r\n\t\t$('.calc__row--hidden').removeClass('calc__row--hidden');\r\n\t\t$('.calc__btn').text('Пересчитать');\r\n\t}\r\n\r\n\tconst links = $('.main-nav__link');\r\n\r\n\tlet linksWidth = {\r\n\t\t\"0\": \"\",\r\n\t\t\"1\": \"\",\r\n\t\t\"2\": \"\",\r\n\t\t\"3\": \"\",\r\n\t\t\"4\": \"\"\r\n\t}\r\n\r\n\tfor (let i = 0; i < links.length; i++) {\r\n\t\tlinksWidth[i] = links.eq(i).outerWidth();\r\n\t};\r\n\r\n\tlet previousId = 0;\r\n\tlet previousWidth = 0;\r\n\r\n\t\r\n\r\n\tconst navCoords = $('.intro').offset().top;\r\n\tfunction onScroll () {\r\n\t\tconst target = $('.main-nav');\r\n\t\tif ($(window).scrollTop() >= navCoords) {\r\n\t\t\ttarget.css('position', 'fixed');\r\n\t\t\ttarget.css('top', '0');\r\n\t\t} else {\r\n\t\t\ttarget.css('position', 'absolute');\r\n\t\t\ttarget.css('top', '100%');\r\n\t\t}\r\n\t};\r\n\r\n\t \r\n\r\n\t$('.calc__form').on('submit', onCalcSubmit);\r\n\tonScroll();\r\n\t$(document)\r\n\t\t.on('scroll', onScroll);\r\n\r\n\t!function() {\r\n\t\tconst sections = $('.section[id]');\r\n\t\tconst progressEl = $('.main-nav__progress');\r\n\t\tconst row = $('.main-nav__row');\r\n\t\tconst positions = {};\r\n\t\tconst links = $('.main-nav__link');\r\n\t\tconst lastTarget = $('.main-nav__link').last().attr('href').slice(1);\r\n\t\tlet spyScroll = true;\r\n\t\tlet progressWidth = 0;\r\n\t\tlet progressMinWidth = 0;\r\n\r\n\r\n\t\tlinks.on('click', onLinkClick)\r\n\r\n\t\tfunction onLinkClick(evt) {\r\n\t\t\tevt.preventDefault();\r\n\t\t\tconst target = $(this);\r\n\t\t\tconst id  = $(this).attr('href');\r\n\t\t\tconst top = $(id).offset().top + 10;\r\n\t\t\tspyScroll = false;\r\n\r\n\t\t\t$('body, html').animate({scrollTop: top}, 1000, () => {\r\n\t\t\t\tspyScroll = true;\r\n\r\n\t\t\t\tscrollHandler.call(null)\r\n\t\t\t});\r\n\r\n\t\t\t\r\n\t\t}\r\n\t\t\r\n\t\tfunction getPositions () {\r\n\t\t\tprogressMinWidth = row.offset().left;\r\n\t\t\tsections.each((idx, el) => {\r\n\t\t\t\tpositions[el.id]= $(el).offset().top\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\tfunction getComputedWidth (target) {\r\n\r\n\t\t\tif(!target) {\r\n\t\t\t\tlinks.removeClass('is-active');\r\n\t\t\t\treturn progressMinWidth\r\n\t\t\t}\r\n\r\n\t\t\tconst el = $(`.main-nav__link[href=\"#${target}\"]`);\r\n\r\n\t\t\tif(target === lastTarget) {\r\n\t\t\t\tsetActive(el);\r\n\t\t\t\treturn '100%';\r\n\t\t\t}\r\n\r\n\t\t\tconst w = el.outerWidth() || 0;\r\n\t\t\tconst p = el.offset().left || 0;\r\n\t\t\tconst result = p + w;\r\n\r\n\t\t\tsetActive(el);\r\n\t\t\treturn result <= 0 ? progressMinWidth : result\r\n\t\t}\r\n\r\n\t\tfunction setActive (el) {\r\n\t\t\tel.addClass('is-active');\r\n\t\t\t$(`.main-nav__link:lt(${el.index()})`).addClass('is-active');\r\n\t\t\t$(`.main-nav__link:gt(${el.index()})`).removeClass('is-active');\r\n\t\t}\r\n\r\n\t\tfunction scrollHandler () {\r\n\t\t\tif(!spyScroll) return;\r\n\t\t\tspyScroll = true\r\n\t\t\tconst top = $(window).scrollTop();\r\n\t\t\tlet target = null;\r\n\t\t\tfor (let i in positions) {\r\n\t\t\t\tif (positions[i] <= top) {\r\n\t\t\t\t\ttarget = i;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tconst w = getComputedWidth(target);\r\n\t\t\tprogressEl.width(w)\r\n\t\t}\r\n\r\n\t\tgetPositions();\r\n\t\tscrollHandler();\r\n\r\n\t\t$(window)\r\n\t\t\t.on('resize', $.debounce(100, getPositions))\r\n\t\t\t.on('scroll', $.debounce(100, scrollHandler))\r\n\t}();\r\n})"]}